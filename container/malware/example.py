#!/bin/env python3
# -*- coding: utf-8 -*-

import json

import requests

URL = "http://127.0.0.1:8080"


def analize_hash(md5hex):
    url = '{}/analizeHash?hash={}'.format(URL, md5hex)
    headers = {'Accept': 'application/json'}
    r = requests.get(url, headers=headers)

    print("analize_hash:", r.status_code)
    print(r.text)
    print('')


def analize_url(my_url):
    data = '''{"url": "%s"}''' % my_url

    myjson = json.dumps(json.loads(data))

    url = '{}/analizeUrl'.format(URL)
    headers = {'Content-type': 'application/json', 'Accept': 'application/json'}
    r = requests.post(url, data=myjson, headers=headers)

    print("analize_url:", r.status_code)
    print(r.text)
    print('')


def download_url(my_url):
    data = '''{"url": "%s"}''' % my_url

    myjson = json.dumps(json.loads(data))

    url = '{}/downloadUrl'.format(URL)
    headers = {'Content-type': 'application/json', 'Accept': 'application/json'}
    r = requests.post(url, data=myjson, headers=headers)

    print("download_url:", r.status_code)
    print(r.text)
    print('')


def get_hash_url(my_url):
    data = '''{"url": "%s"}''' % my_url

    myjson = json.dumps(json.loads(data))

    url = '{}/getHash'.format(URL)
    headers = {'Content-type': 'application/json', 'Accept': 'application/json'}
    r = requests.post(url, data=myjson, headers=headers)

    print("get_hash_url:", r.status_code)
    print(r.text)
    print('')


def reputation_ip(ip):
    url = '{}/getReputationIp?ip={}'.format(URL, ip)
    headers = {'Accept': 'application/json'}
    r = requests.get(url, headers=headers)

    print("reputation_ip:", r.status_code)
    print(r.text)
    print('')


list_hash = ('d1bdc5aaa294b4c52678c4c60f052569', '087951566fb77fe74909d4e4828dd4cb',
             '8aacf26df235661245e98cb60e820f51', 'be0d32bb3a12896ff16e3f667eb4b644',
             'f388391ca443056fd3b4cc733c3b61cd', '344324e74971148b2b537e35511cacba',
             'd6113972a2173a5f81da9d37cc43bbaa', 'f96980293893c2b1f5da2d634a7e2a06',
             '0a60424e0967b6cfc172dac82e10a2fe', '13f998379288f3c92c0d6cda66c701bc',
             '76a2f2ce03df87d87a45ab7890808a40', '66f534535b1647618f805f2aaca84fce',
             '2d9a3315b9ff59d1db0b7cc4624a2c87', 'fca4501c008103081a7ec43e455678ff',
             'f603ff7e25027ff6892118ab3ce2c07c', '978a0e667f0aea05984b4b746b3c42c4',
             '51a057635fd5d481dd9dd6f0dc316370', '705647da49085cd19ac9a74715a36f38')

list_url = (
'https://raw.githubusercontent.com/procamora/IN1-INCIBE/master/container/malware/Dockerfile?token=ACAGUU6MHVHS7H7NNS25RDC5E475G',
'https://raw.githubusercontent.com/procamora/IN1-INCIBE/master/container/malware/Dockerfile?token=ACAGUU6MHVHS7H7NNS25RDC5E475G',
'https://raw.githubusercontent.com/procamora/IN1-INCIBE/master/container/malware/Dockerfile?token=ACAGUU6MHVHS7H7NNS25RDC5E475G',
'https://raw.githubusercontent.com/procamora/IN1-INCIBE/master/container/malware/connect_sqlite.py?token=ACAGUU3IF6D2MCCXQRDEL7S5E475K',
'raw.githubusercontent.com/procamora/IN1-INCIBE/master/container/malware/connect_sqlite.py?token=ACAGUU3IF6D2MCCXQRDEL7S5E475K',
'https://urlhaus.abuse.ch/browse/',
"https://pypi.org/static/images/logo-small.6eef541e.svg",
"http://121.174.70.181/zehir/z3hir.sh4",
"https://miro.medium.com/max/790/1*uHzooF1EtgcKn9_XiSST4w.png",
'https://raw.githubusercontent.com/procamora/Gestor-Series/master/app/modulos/funciones.py')

for i in list_hash:
    # break
    print(i)
    analize_hash(i)
    break

for i in list_url:
    break
    print(i)
    analize_url(i)

for i in list_url:
    break
    print(i)
    download_url(i)

for i in list_url:
    # break
    print(i)
    get_hash_url(i)
    break

list_ip = ('5.188.86.174',
           '15.188.86.173',
           '185.220.221.209',
           '185.220.221.202',
           '5.188.86.172',
           '5.9.40.169',
           '176.9.127.55',
           )

for i in list_ip:
    break
    print(i)
    reputation_ip(i)
# urlAnalize()
# md5("815f40789226a46453943b3fe7ad1eaf")
# download()
